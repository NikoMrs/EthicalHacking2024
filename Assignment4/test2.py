from Crypto.Util.number import long_to_bytes, bytes_to_long

rsa_n = 135225184797352238956993252284290353963628555230609411331511579550581414665636061957438738067330864251572269029201241285142988911575674611843767430873577205717882073494901661588940787272851100218353509387874111023865399990018460435399917751526038182264491743674852523720465579662692140940284835579809428254867
rsa_e = 65537
rsa_d = 52111742485037889239632903240795843259615221796912756039926399638822103678766259987443318562468655988795782940957116589065281107630120969783880712180036701694226345826970040315623060661606716946939672482207627604466639683281278498223391603914187707199287118698840462523582992956328913525723035521093194955201

FLAG = b"UniTN{placeholder_flag}"
c = 92242938589985083539838961106121615580163216811574214466817823048027201373672443207393843357358412787270688393404015918691178266986432907105533038459129095088685227815498082768913910122818647417516237764883517532434342628563476308436225680560965645672500436652895549487692066059529827503146685121965073902738
my_c = pow(bytes_to_long(FLAG), rsa_e, rsa_n)
print("c " , c == my_c)

c_a = 134323612619526302215815852686627168675882467254186336225971646386178839653529906147195719378403498101150396607122834254330711820835200773131405524557278247039737680811096569315424096500756345193995877360082005207538556216555671239266337815950447893259798161482730108908549205397978037046443194263796548346191
my_ca = pow(50, rsa_e, rsa_n)
print("ca" , c_a == my_ca)

c_b = 12390404750047910097366956640817089191426630222404928442365312525059391204700995530246243117939404495930112533694659613265533561160342077075062790078594717218777023955440367809196300690421293521081327613887808188584192681111184190235284095509795512526340459830955270832936100148916480687914003818151457306271353156336542532024395372496208177303329576825512308823929270358834699189117747708103558594078111320952178062806461500815132239516631487301614359442884771655212486007385028906571326000507407471547814821879085552628729376708072195606661268639077373708282281694779249400335064818180939754397606337383047886770958
my_cb = my_c * my_ca
print("cb" , c_b == my_cb)

m = 16365384771869256945113296725134338680054550229200064250
my_m = pow(my_cb, rsa_d, rsa_n)
print("m " , m == my_m)

print(int(my_m/50))
print(long_to_bytes(int(my_m/50)))

a = 42668744939867705579674881675896231322193694052494967737809278168910508366203116463843843142987474439869888751888788748212198316612261018559278955025937840103574822231934030798332697743110735308807368740725022371253847401579423308513092138678907691232749455372285402616240530310571220290475546352843319115903
b = 92242938589985083539838961106121615580163216811574214466817823048027201373672443207393843357358412787270688393404015918691178266986432907105533038459129095088685227815498082768913910122818647417516237764883517532434342628563476308436225680560965645672500436652895549487692066059529827503146685121965073902738
ab = a * b
print("Ab", ab)
dec_ab = pow(ab, rsa_d, rsa_n)
dec_ab = 409134619296731423627832418128358467001363755730001606250
secret = dec_ab / 2
print("Secret", int(secret))
print(long_to_bytes(int(secret)))
