import pwn
from Crypto.Util.number import bytes_to_long, long_to_bytes
from random import randint

IP_ADDRESS = "cyberchallenge.disi.unitn.it"
PORT = 10401

conn = pwn.remote(IP_ADDRESS, PORT)

BLOCK_SIZE = 16
p = 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919
g = 2

conn.recvuntil(b": ")
conn.recvuntil(b": ")
conn.recvuntil(b": ")

ga_alice = int(conn.recvline(keepends=False).decode())

b_alice = 2
b_bob = 2

gb_bob = pow(g, b_bob, p)

conn.recvuntil(b": ")
conn.sendline(long_to_bytes(gb_bob))

gb_alice = pow(g, b_alice, p)


conn.interactive()

