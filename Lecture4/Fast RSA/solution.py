import math
from Crypto.Util.number import long_to_bytes

n = [None] * 3
n[0] = 170512297332859605501894645915292779190173738534041656729523408995567045747611001879956735386579942065804667904951398374014619927033070761369550551939235657815586550618920448672945626596924729948765876071275299727581222135571930103152201096296330391171287232328530527838354682646613009384803871812428265051487
n[1] = 118568558557834604938631968431231567030576485461776361706187041609368761702651413090874741092596532700364454741067454599510283245076697030668304942981356676099683058490571642065880396815141503978102319374863866874238997049367687423970611750294297184879133631341840218693041682522429789192869812778520740241053
n[2] = 156657733748727082536826706255961503289054545971676931392382511509907272414326473986353746527391329074200128907919910492196002070656500567570647415137286211497346183231894937842736485958362970966020720178700097640749455885229173595993672453349186357774335845252419713402550678484440590999426112089249393653543 

with open("message.txt", "r") as f:
    aux = f.readline()
    e = int(f.readline())
    c = int(f.readline())

p = q = math.isqrt(n)
while True:
    if p * q == n:
        break
    p -= 1
    while(p*q  < n):
        q += 1

d = pow(e, -1, (p-1)*(q-1))
m = pow(c, d, n)

print(f"Difference between p and q: {q-p}")
print(f"Flag: {long_to_bytes(m).decode()}")